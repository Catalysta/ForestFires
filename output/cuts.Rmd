---
title: "Cuts"
author: "Christina Sousa"
date: "March 20, 2019"
output: html_document
---
We also noticed a trend in observation order with respect to `Larea`: this is likely due to the fact that this data came from two different data sets which were combined manually. [citation] When combining the two data sets, it seems that the first set was sorted by `area`, while the second set was ordered chronologically:
  
```{r}
plot(forest3$Larea, main = "Observation Order vs. log(area)")

```

With respect to the spacial coordinates, it seems that the `X` and `Y` coordinates would be better explained by assigning each grid of the map its own category, to see if one area of the map appears more than others. Indeed, there are 4 regions (out of 81) of the map that had 20 or more fires in this 3-year period. It may be interesting to compare the sizes of fires in these areas, and whether these fires are bigger than fires in other areas of the park.

```{r}
forest4<-cbind(paste(forest3$X,forest3$Y,sep = ","),forest3[,3:13])
colnames(forest4)[1]<-"XY"
summary(forest4)
plot(forest4$XY, main = "Number of Fires by Park Region", ylab = "Number of Fires",
     xlab = "Spatial Coordinates")
```



We generate a correlation matrix to check for linear dependence. It appears that `FFMC` and `ISI` are highly correlated (0.7042), as well as `DC` and `DMC` (0.6689), `temp` and `FFMC` (0.5623). Furthermore, `temp` and `DMC` have somewhat high linear correlation (0.5016),along with `temp` and `RH` (-0.4975), `temp` and `DC`(0.4957) and `FFMC` and `DMC` (0.4803). Finally, `temp` and `ISI` appear to be somewhat linearly correlated (0.4660), along with `FFMC` and `DC` (0.4076).

```{r}
cor(forest5[,c(5:11,14)])
```


```{r}
require(car)
summary(powerTransform(cbind(TrFFMC,DMC,DC,ISI,temp,RH,wind)~1,train,family="yjPower"))
yj.TrFFMC<-yjPower(train$TrFFMC,2.5)
yj.DMC<-yjPower(train$DMC,.33)
yj.DC<-yjPower(train$DC,1.5)
yj.ISI<-yjPower(train$ISI,0)
yj.RH<-yjPower(train$RH,0)
yj.wind<-yjPower(train$wind,0.5)

train2<-cbind(train[,-c(6:9,11:12,16:85)],yj.TrFFMC,yj.DMC,yj.DC,yj.ISI,yj.RH,yj.wind)

```



```{r}
#try forward/backward selection on the augmented data
fit0<-lm(Larea~1,dat=train2)
fitfull<-lm(Larea~.,dat=train2)

# Forward selection
step(fit0,scope=list(lower=fit0,upper=fitfull),direction="forward")

# Backward elimination
step(fitfull,scope=list(lower=fit0,upper=fitfull),direction="backward")

# Stepwise regression
step(fit0,scope=list(lower=fit0,upper=fitfull),direction="both")
```

```{r}
fwd.yj.model<-lm(formula = Larea ~ yj.ISI + yj.RH + week + yj.TrFFMC + temp, 
    data = train2)
summary(fwd.yj.model)

bwd.yj.model<-lm(formula = Larea ~ month + yj.DMC + yj.DC + yj.ISI + yj.RH, 
    data = train2)
summary(bwd.yj.model)

stepwise.regression.model<-lm(formula = Larea ~ yj.ISI + yj.RH + week + yj.TrFFMC + temp, 
    data = train2)
summary(stepwise.regression.model)
```




